---
phase: 01-foundation-auth
plan: 03
type: execute
wave: 3
depends_on: ["01-01", "01-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Complete authentication flow works end-to-end"
    - "User can register, login, access dashboard, and logout"
    - "Session persists across page refresh"
    - "Protected routes redirect unauthenticated users"
    - "Passwords are hashed in database"
  artifacts: []
  key_links: []
---

<objective>
Verify complete authentication flow works end-to-end from user perspective.

Purpose: Human validation that all Phase 1 requirements are met and auth system is production-ready for Phase 2.
Output: Confirmed working auth system ready for voice pipeline integration.
</objective>

<execution_context>
@D:\.claude\get-shit-done\workflows\execute-plan.md
@D:\.claude\get-shit-done\templates\summary.md
</execution_context>

<context>
@D:\Capstone\.planning\PROJECT.md
@D:\Capstone\.planning\ROADMAP.md
@D:\Capstone\.planning\STATE.md
@D:\Capstone\.planning\phases\01-foundation-auth\01-01-SUMMARY.md
@D:\Capstone\.planning\phases\01-foundation-auth\01-02-SUMMARY.md

Plans 01 and 02 implemented complete auth system (backend + frontend). This plan verifies everything works correctly before moving to Phase 2.
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete authentication system:
- SQLite database with User table
- Registration API endpoint with bcrypt password hashing
- Login API endpoint with JWT generation
- Logout API endpoint
- Route protection middleware
- Login UI (black theme, minimal design)
- Registration UI (black theme, minimal design)
- Protected dashboard UI
- Session persistence via HTTP-only cookies
  </what-built>

  <how-to-verify>
Run through complete user flow:

**Step 1: Start dev server**
```bash
cd D:\Capstone
npm run dev
```
Visit http://localhost:3000

**Step 2: First visit (UI-01)**
- Expected: Should automatically redirect to /login
- Expected: Login page has black background, white text, minimal form
- Check: URL is http://localhost:3000/login

**Step 3: Registration (UI-02, AUTH-01, AUTH-02)**
- Click "Register" or "Don't have an account?" link
- Expected: Register page renders (black theme)
- Enter email: `test2021001@college.edu` (includes roll number 2021001)
- Enter password: `securepass123` (min 8 chars)
- Click Submit/Register button
- Expected: Account created, redirected to login or dashboard

**Step 4: Login (AUTH-03, AUTH-04, AUTH-05)**
- On login page, enter same credentials
- Click Login/Submit
- Expected: Redirected to http://localhost:3000/dashboard
- Expected: Dashboard shows welcome message
- Check browser DevTools → Application → Cookies → localhost
- Expected: Cookie named `token` exists with HttpOnly flag set

**Step 5: Session persistence (AUTH-06)**
- While on dashboard, press F5 to refresh page
- Expected: Stay on dashboard (not redirected to login)
- Close browser completely
- Reopen browser, visit http://localhost:3000/dashboard
- Expected: Still logged in, dashboard loads (cookie persists)

**Step 6: Route protection (AUTH-07)**
- Click Logout button on dashboard
- Expected: Redirected to /login
- Try visiting http://localhost:3000/dashboard directly
- Expected: Middleware redirects to /login (route protected)

**Step 7: Password security (AUTH-02, DATA-01)**
- Open SQLite database viewer (DB Browser for SQLite, or command line)
- Open file: `D:\Capstone\data\auth.db`
- Query: `SELECT email, password FROM users;`
- Expected: Password column shows bcrypt hash (starts with `$2b$10$`), NOT plain text
- Expected: Email matches registered email

**Step 8: Roll number extraction**
- Check database: `SELECT email, rollNumber FROM users;`
- Expected: rollNumber column contains `test2021001` (extracted from email local part)

**Success indicators:**
✓ All pages use pure black background (#000)
✓ Registration creates account
✓ Login authenticates and sets cookie
✓ Dashboard loads after login
✓ Session survives page refresh
✓ Logout clears session
✓ Protected routes redirect when not authenticated
✓ Passwords are hashed (bcrypt hash visible in database)
✓ Roll number extracted and stored correctly

**Failure indicators (report these):**
✗ White background instead of black
✗ Plain text passwords in database
✗ Session lost after refresh
✗ Can access dashboard without login
✗ Cookie missing or not HttpOnly
✗ Errors in browser console
✗ API errors in terminal
  </how-to-verify>

  <resume-signal>
Type "approved" if all verification steps pass.

If issues found, describe them:
- What failed (specific step)
- What you expected vs what happened
- Any error messages (browser console or terminal)
  </resume-signal>
</task>

</tasks>

<verification>
Human verification complete when:
- User confirms all 8 verification steps pass
- No critical issues blocking Phase 2
- Auth system meets all Phase 1 requirements
</verification>

<success_criteria>
All Phase 1 success criteria validated by human:
1. ✓ User can create new account with email and password
2. ✓ User can log in with credentials and stay logged in across browser refreshes
3. ✓ User is redirected to login when accessing protected routes without authentication
4. ✓ User passwords are never stored in plain text (verified via database inspection)
</success_criteria>

<output>
After human approval, create `.planning/phases/01-foundation-auth/01-03-SUMMARY.md`
</output>
